---
import { Icon } from 'astro-icon/components';

export interface Props {
  text: string;
  url: string | URL;
  class?: string; // classi extra per il wrapper
}

const { text, url, class: className = '' } = Astro.props;

// valori codificati per gli href
const shareUrl = typeof url === 'string' ? url : (url as URL).href;
const u = encodeURIComponent(shareUrl);
const t = encodeURIComponent(text || '');

// href nativi (no JS) dove possibile
const telegramHref = `https://t.me/share/url?url=${u}&text=${t}`;
---

<!-- wrapper NON spezzabile, tutto su una riga -->
<div
  class={`inline-flex items-center gap-3 whitespace-nowrap text-neutral-500 ${className}`}
  id="aw-share-bar"
>
  <span class="font-bold text-slate-500 dark:text-slate-400">Share:</span>

  <!-- Facebook (lasciato come button: gestito dallo script del tema) -->
  <button
    class="ml-1"
    title="Facebook Share"
    data-aw-social-share="facebook"
    data-aw-url={shareUrl}
    data-aw-text={text}
  >
    <Icon
      name="tabler:brand-facebook"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </button>

  <!-- LinkedIn (script del tema) -->
  <button
    class="ml-1"
    title="LinkedIn Share"
    data-aw-social-share="linkedin"
    data-aw-url={shareUrl}
    data-aw-text={text}
  >
    <Icon
      name="tabler:brand-linkedin"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </button>

  <!-- WhatsApp (script del tema) -->
  <button
    class="ml-1"
    title="WhatsApp Share"
    data-aw-social-share="whatsapp"
    data-aw-url={shareUrl}
    data-aw-text={text}
  >
    <Icon
      name="tabler:brand-whatsapp"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </button>

  <!-- âœ… Telegram: ANCHOR con href nativo (nessun JS richiesto) -->
  <a
    class="ml-1 inline-flex"
    href={telegramHref}
    target="_blank"
    rel="noopener noreferrer"
    title="Telegram Share"
    aria-label="Condividi su Telegram"
  >
    <Icon
      name="tabler:brand-telegram"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </a>

  <!-- Email (script del tema) -->
  <button
    class="ml-1"
    title="Email Share"
    data-aw-social-share="mail"
    data-aw-url={shareUrl}
    data-aw-text={text}
  >
    <Icon
      name="tabler:mail"
      class="w-6 h-6 text-gray-400 dark:text-slate-500 hover:text-black dark:hover:text-slate-300"
    />
  </button>
</div>