---
// src/layouts/PortfolioLayout.astro
import Layout from '@/layouts/PageLayout.astro';

export interface Props {
  title: string;
  description?: string;
  image?: string | { src: string; alt?: string; width?: number; height?: number };
  category?: string;
  technologies?: Array<string | { name: string; icon?: string }>;
  metadata?: Record<string, any>;
}

const {
  title,
  description,
  image,
  category,
  technologies = [],
  metadata = {},
} = Astro.props as Props;

const cover =
  typeof image === 'string'
    ? { src: image, alt: title, width: 1200, height: 630 }
    : {
        src: image?.src ?? '',
        alt: image?.alt?.trim() ? image.alt : title,
        width: image?.width ?? 1200,
        height: image?.height ?? 630,
      };

const techList = (technologies || [])
  .map((t) => (typeof t === 'string' ? t : t?.name ?? ''))
  .filter(Boolean);
---

<Layout metadata={metadata}>
  <section class="container mx-auto px-6 py-12">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
      <!-- Colonna Sinistra: Immagine -->
      <div class="flex items-center justify-center">
        {cover.src ? (
          <img
            src={cover.src}
            alt={cover.alt}
            width={cover.width}
            height={cover.height}
            loading="eager"
            decoding="async"
            class="rounded-lg shadow-lg w-full h-auto"
          />
        ) : (
          <div class="bg-gray-300 w-full h-[400px] flex items-center justify-center text-gray-600 rounded-lg">
            Nessuna immagine disponibile
          </div>
        )}
      </div>

      <!-- Colonna Destra: Dettagli -->
      <div>
        <h1 class="text-3xl font-bold mb-4">{title}</h1>
        {description && <p class="text-gray-600 mb-6">{description}</p>}

        <div class="space-y-4">
          {category && (
            <div class="flex items-center">
              <span class="font-semibold text-lg">Categoria:</span>
              <span class="ml-2 px-3 py-1 bg-gray-200 text-gray-800 rounded-md">{category}</span>
            </div>
          )}

          {techList.length > 0 && (
            <div>
              <h3 class="font-semibold text-lg mb-2">Tecnologie utilizzate:</h3>
              <div class="flex flex-wrap gap-2">
                {techList.map((label) => (
                  <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-md text-sm">{label}</span>
                ))}
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  </section>
</Layout>