---
import Layout from '@/layouts/PageLayout.astro';
import HeroText from '@/components/widgets/HeroText.astro';
import Features2 from '@/components/widgets/Features2.astro';
import { Fragment } from 'astro/jsx-runtime';

const metadata = {
  title: 'Contatti - LS Web Agency',
  description: 'Hai bisogno di informazioni? Contattaci per una consulenza gratuita.',
  canonical: '/contatti',
  openGraph: {
    type: 'website',
    url: 'https://lswebagency.com/contatti',
    title: 'Contatti - LS Web Agency',
    description: 'Contattaci per discutere il tuo progetto.',
  },
  twitter: {
    card: 'summary_large_image',
    site: '@lswebagency',
    title: 'Contatti - LS Web Agency',
    description: 'Richiedi una consulenza gratuita.',
  }
};
---

<Layout metadata={metadata}>
  <!-- Hero -->
  <HeroText
    tagline="Contatti"
    title="Hai bisogno di informazioni?"
  />

  <section class="text-center max-w-3xl mx-auto mb-12">
    <p class="text-xl font-medium">
      Hai un progetto in mente?
      <a href="#contact" class="text-blue-500 underline"> Contattaci oggi stesso</a>
      e trasformiamo le tue idee in realtà!
    </p>
  </section>

  <!-- Sezione Contatti Rapidi -->
  <Features2
    title="Siamo qui per aiutarti!"
    columns={3}
    items={[
      {
        title: 'Contatti Rapidi',
        description: `
          <div class="flex gap-4 mt-2">
            <a href="https://wa.me/393403223494" class="btn-whatsapp">WhatsApp</a>
            <a href="https://t.me/lswebagency" class="btn-telegram">Telegram</a>
          </div>`,
        icon: 'tabler:message',
      },
      {
        title: 'Telefono',
        description: '<a href="tel:+393403223494" class="contact-link">+39 340 3223 494</a>',
        icon: 'tabler:headset',
      },
      {
        title: 'Email',
        description: '<a href="mailto:info@lswebagency.com" class="contact-link">info@lswebagency.com</a>',
        icon: 'tabler:mail',
      },
    ]}
  />

  <!-- Intro al form -->
  <section id="contact" class="max-w-lg mx-auto text-center mt-16 mb-6">
    <h2 class="text-2xl font-semibold">Compila il form</h2>
    <p class="text-gray-600 dark:text-gray-400">
      Raccontaci il tuo progetto: compila tutti i campi e ti risponderemo il prima possibile.
    </p>
  </section>

 <!-- Sezione Form di Contatto -->
<section class="max-w-lg mx-auto bg-white dark:bg-gray-900 p-6 rounded-lg shadow-xl mb-16">
  <form
    action="https://formspree.io/f/mldgyarp"
    method="POST"
    class="space-y-4"
  >
    <!-- Redirect alla pagina di ringraziamento -->
    <input type="hidden" name="_redirect" value="https://lswebagency.com/grazie" />

    <!-- Subject personalizzato -->
    <input type="hidden" name="_subject" value="Nuova richiesta da LS Web Agency – Form Contatti" />

    <!-- Honeypot anti-spam -->
    <div style="display: none;">
      <label for="honeypot">Lascia questo campo vuoto</label>
      <input type="text" name="honeypot" id="honeypot" />
    </div>

    <!-- Nome -->
    <input
      type="text"
      name="name"
      placeholder="Nome e Cognome *"
      required
      class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-800 dark:text-white"
    />

    <!-- Email (Reply-To per Formspree) -->
    <input
      type="email"
      name="_replyto"
      placeholder="Email *"
      required
      class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-800 dark:text-white"
    />

    <!-- Telefono -->
    <input
      type="tel"
      name="phone"
      placeholder="Telefono"
      class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-800 dark:text-white"
    />

    <!-- Servizio di interesse -->
    <select
      name="service"
      required
      class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-800 dark:text-white"
    >
      <option value="" disabled selected hidden>Servizio di interesse *</option>
      <option value="siti-web">Creazione Sito Web</option>
      <option value="ecommerce">E-commerce</option>
      <option value="seo">SEO</option>
      <option value="grafica">Branding e Grafica</option>
      <option value="altro">Altro</option>
    </select>

    <!-- Messaggio -->
    <textarea
      name="message"
      rows="5"
      placeholder="Messaggio *"
      required
      class="w-full border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-800 dark:text-white"
    ></textarea>

    <!-- Privacy -->
    <div class="flex items-start">
      <input type="checkbox" name="privacy" required class="h-4 w-4 text-blue-600 rounded" />
      <label class="ml-2 text-sm">* Accetto la raccolta e l’elaborazione dei dati.</label>
    </div>

    <!-- Submit -->
    <button
      type="submit"
      class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded px-4 py-2 focus:outline-none focus:ring"
    >
      Invia Richiesta
    </button>
  </form>

  <!-- Semplice timeout anti-double-submit -->
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.querySelector('form');
      const t0 = Date.now();
      form.addEventListener('submit', (e) => {
        if (Date.now() - t0 < 3000) {
          e.preventDefault();
          alert('Attendi almeno 3 secondi prima di inviare.');
        }
      });
    });
  </script>
</section>
</Layout>