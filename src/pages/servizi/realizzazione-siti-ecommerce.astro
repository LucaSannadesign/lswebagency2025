---
import Layout from '@/layouts/PageLayout.astro';
import Testimonials from '@/components/widgets/Testimonials.astro';
import CallToAction from '@/components/widgets/CallToAction.astro';

// ✅ HERO image import (ESM) così conosciamo width/height ed evitiamo CLS
import ecommerceHero from '@/assets/images/ecommerce-business-online.webp';

const metadata = {
  title:
    'Realizzazione E-commerce a Sassari | Siti Vendita Online Professionali - LS Web Agency',
  description:
    'Soluzioni E-commerce scalabili, ottimizzate per SEO e conversioni. Dallo shop essenziale a progetti complessi integrati con gestionale e automazioni.',
  canonical: '/servizi/realizzazione-siti-ecommerce',
};

// ⚙️ PayPal Hosted Buttons (se non presenti -> fallback ai contatti)
const paypalEnv = (import.meta.env.PUBLIC_PAYPAL_ENV || 'live').toLowerCase();
const paypalAction =
  paypalEnv === 'sandbox'
    ? 'https://www.sandbox.paypal.com/cgi-bin/webscr'
    : 'https://www.paypal.com/cgi-bin/webscr';

const PP_START = import.meta.env.PUBLIC_PAYPAL_ECOM_START_BTN_ID || '';
const PP_PRO   = import.meta.env.PUBLIC_PAYPAL_ECOM_PRO_BTN_ID || '';

// Dove atterrare post-acquisto / annullamento (aggiorna col tuo dominio)
const RETURN_BASE = 'https://www.tuodominio.it';
---

<Layout metadata={metadata}>
  <!-- HERO -->
  <section class="relative overflow-hidden isolate">
    <!-- Gradiente top (più basso e tenue) -->
    <div
      aria-hidden="true"
      class="pointer-events-none absolute inset-x-0 top-0 -z-10
             h-[460px] sm:h-[520px] md:h-[560px]
             bg-gradient-to-b from-blue-100/70 via-white to-transparent
             dark:from-blue-900/30 dark:via-transparent">
    </div>

    <div class="container mx-auto px-6 pt-16 md:pt-20 pb-12">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <!-- Testo (sx) -->
        <div>
          <p class="mb-2 inline-flex items-center text-xs font-semibold uppercase tracking-wide text-blue-700/90 dark:text-blue-300">
            E-commerce • Vendita Online
          </p>

          <h1 class="text-3xl md:text-5xl font-extrabold leading-tight">
            <span class="text-neutral-900 dark:text-neutral-100">Realizzazione</span>
            <span class="ml-2 bg-clip-text supports-[background-clip:text]:text-transparent
                         bg-gradient-to-r from-neutral-900 via-blue-700 to-blue-600
                         dark:from-neutral-100 dark:via-blue-400 dark:to-blue-300">
              Siti E-commerce a Sassari
            </span>
          </h1>

          <p class="mt-4 text-base md:text-lg text-neutral-700 dark:text-neutral-300 max-w-prose">
            <span class="font-semibold">LS Web Agency</span> sviluppa <strong>soluzioni E-commerce</strong> su misura,
            <strong> scalabili</strong> e ottimizzate per <strong>SEO</strong> e <strong>conversioni</strong>:
            dallo shop essenziale ai progetti avanzati con integrazioni e automazioni.
          </p>

          <div class="mt-6 flex flex-wrap gap-3">
            <a href="#pacchetti"
               class="inline-flex items-center justify-center rounded-full px-5 py-3 text-white bg-blue-600 hover:bg-blue-700 transition">
              Scopri le soluzioni E-commerce
            </a>
            <a href="/portfolio"
               class="inline-flex items-center justify-center rounded-full px-5 py-3 ring-1 ring-neutral-300 text-neutral-900 hover:bg-neutral-100 dark:text-neutral-100 dark:ring-neutral-700 dark:hover:bg-neutral-800 transition">
              Portfolio
            </a>
          </div>
        </div>

        <!-- Immagine (dx) — più compatta: altezza fissa + crop -->
        <div class="relative md:ml-auto">
          <figure
            class="rounded-2xl overflow-hidden shadow-lg ring-1 ring-neutral-200 dark:ring-neutral-800
                   w-full max-w-[560px] lg:max-w-[600px]">
            <img
              src={ecommerceHero.src}
              alt="Negozio online e dashboard e-commerce"
              class="w-full
                     h-[240px] sm:h-[300px] md:h-[340px] lg:h-[380px]
                     object-cover"
              loading="eager"
              decoding="async"
              fetchpriority="high"
              width={ecommerceHero.width}
              height={ecommerceHero.height}
              sizes="(min-width:1024px) 600px, (min-width:768px) 48vw, 92vw"
            />
          </figure>
        </div>
      </div>
    </div>
  </section>

  <!-- COSA OTTIENI -->
  <section class="container mx-auto px-6 py-8">
    <h2 class="sr-only">Cosa ottieni</h2>
    <div class="grid md:grid-cols-3 gap-4">
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Velocità & Stabilità</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Asset ottimizzati, immagini adattive, caching e CDN per checkout rapido e affidabile.
        </p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">SEO Tecnico & On-Page</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Architettura, dati strutturati, feed prodotto, schema, paginazioni corrette e logica canonicals.
        </p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Design che converte</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          UX per ridurre attriti: ricerca, filtri, variant picker, trust & social proof, pagine promo.
        </p>
      </div>
    </div>

    <!-- Core Web Vitals -->
    <div class="grid md:grid-cols-3 gap-4 mt-4">
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <h3 class="font-semibold">Core Web Vitals: perché contano</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Miglioriamo tempi di caricamento, interattività e stabilità visiva: impattano SEO e tassi di conversione.
        </p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <p class="text-sm text-neutral-700 dark:text-neutral-300">
          <strong>LCP ≤ 2.5s</strong> su mobile • <strong>INP ≤ 200ms</strong> • <strong>CLS ≤ 0.10</strong><br/>
          Audit con Lighthouse/CrUX e remediation mirate.
        </p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <p class="text-sm text-neutral-700 dark:text-neutral-300">
          Code-splitting, immagini ottimizzate, cache headers, HTTP/2, lazy load e prefetch strategici.
        </p>
      </div>
    </div>
  </section>

  <!-- PACCHETTI -->
  <section id="pacchetti" class="container mx-auto px-6 py-10">
    <h2 class="text-3xl md:text-4xl font-bold text-center mb-8">Pacchetti E-commerce</h2>

    <div class="grid md:grid-cols-2 gap-6">
      <!-- START -->
      <article class="rounded-2xl p-6 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/50">
        <h3 class="text-xl font-semibold">E-commerce Start</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-400 mt-1">Per negozi fino a ~100 prodotti.</p>
        <ul class="mt-4 space-y-2 text-sm text-neutral-700 dark:text-neutral-300">
          <li>• Tema personalizzato mobile-first</li>
          <li>• Pagamenti (PayPal/Stripe), spedizioni base</li>
          <li>• SEO tecnico iniziale + dati strutturati</li>
          <li>• Integrazione analytics & pixel</li>
          <li>• Formazione 1h + manuale rapido</li>
        </ul>

        <!-- CTA: PayPal (se ID presente) + contatto -->
        <div class="mt-5 flex flex-col sm:flex-row gap-3 items-start sm:items-center">
          {PP_START
            ? (
              <form action={paypalAction} method="post" target="_top" class="inline-block">
                <input type="hidden" name="cmd" value="_s-xclick" />
                <input type="hidden" name="hosted_button_id" value={PP_START} />
                <input type="hidden" name="currency_code" value="EUR" />
                <input type="hidden" name="return" value={`${RETURN_BASE}/grazie?prodotto=ecom-start`} />
                <input type="hidden" name="cancel_return" value={`${RETURN_BASE}/servizi/realizzazione-siti-ecommerce#pacchetti`} />
                <button type="submit" aria-label="Acquista ora — E-commerce Start (PayPal)">
                  <img src="https://www.paypalobjects.com/it_IT/i/btn/btn_buynowCC_LG.gif" alt="Paga adesso con PayPal" />
                </button>
              </form>
            )
            : (
              <a href="/contatti" class="inline-flex justify-center rounded-full px-5 py-3 bg-indigo-600 text-white hover:bg-indigo-700">
                Richiedi preventivo
              </a>
            )
          }

          <a href="/contatti" class="inline-flex justify-center rounded-full px-5 py-3 border border-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800">
            Parla con noi
          </a>
        </div>

        <p class="mt-2 text-xs text-neutral-500">Pagamento sicuro con PayPal.</p>
      </article>

      <!-- PRO -->
      <article class="relative overflow-hidden rounded-2xl p-6 ring-2 ring-indigo-600 dark:ring-indigo-500 ring-offset-2 ring-offset-white dark:ring-offset-neutral-900 shadow-lg bg-gradient-to-br from-zinc-50 via-neutral-100 to-zinc-200 dark:from-neutral-900 dark:via-neutral-800 dark:to-neutral-700">
        <div class="flex items-start justify-between h-7">
          <span aria-hidden="true" class="inline-block h-7"></span>
          <span class="inline-flex text-xs font-semibold px-2.5 py-1 rounded-full bg-indigo-600 text-white">Più scelto</span>
        </div>
        <h3 class="mt-3 text-xl font-semibold">E-commerce Pro</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-400 mt-1">Per cataloghi complessi e crescita veloce.</p>
        <ul class="mt-4 space-y-2 text-sm text-neutral-700 dark:text-neutral-300">
          <li>• Tutto di Start + UX per AOV e ripetizione d’acquisto</li>
          <li>• Listini/varianti avanzati, regole spedizione</li>
          <li>• Automazioni marketing (email/recupero carrelli)</li>
          <li>• Integrazioni (gestionale/CRM) su richiesta</li>
          <li>• Supporto e reportistica mensile</li>
        </ul>

        <!-- CTA: PayPal (se ID presente) + contatto -->
        <div class="mt-5 flex flex-col sm:flex-row gap-3 items-start sm:items-center">
          {PP_PRO
            ? (
              <form action={paypalAction} method="post" target="_top" class="inline-block">
                <input type="hidden" name="cmd" value="_s-xclick" />
                <input type="hidden" name="hosted_button_id" value={PP_PRO} />
                <input type="hidden" name="currency_code" value="EUR" />
                <input type="hidden" name="return" value={`${RETURN_BASE}/grazie?prodotto=ecom-pro`} />
                <input type="hidden" name="cancel_return" value={`${RETURN_BASE}/servizi/realizzazione-siti-ecommerce#pacchetti`} />
                <button type="submit" aria-label="Acquista ora — E-commerce Pro (PayPal)">
                  <img src="https://www.paypalobjects.com/it_IT/i/btn/btn_buynowCC_LG.gif" alt="Paga adesso con PayPal" />
                </button>
              </form>
            )
            : (
              <a href="/contatti" class="inline-flex justify-center rounded-full px-5 py-3 bg-indigo-600 text-white hover:bg-indigo-700">
                Richiedi preventivo
              </a>
            )
          }

          <a href="/contatti" class="inline-flex justify-center rounded-full px-5 py-3 border border-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800">
            Parla con noi
          </a>
        </div>

        <p class="mt-2 text-xs text-neutral-300">Pagamento sicuro con PayPal.</p>
      </article>
    </div>
  </section>

  <!-- TECNOLOGIE & CMS -->
  <section class="container mx-auto px-6 py-10">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">Tecnologie & CMS</h2>
    <p class="text-neutral-600 dark:text-neutral-300 mb-6">
      Scegliamo lo stack più adatto per contenuti aggiornabili, performance, integrazioni e budget.
      Specifica sempre tecnologia & CMS nel preventivo.
    </p>

    <div class="grid md:grid-cols-3 gap-6">
      <article class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">WooCommerce (classico/leggero)</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Cataloghi flessibili, tassazioni e spedizioni, pagamenti multipli. Hardening e pulizia plugin per massima stabilità.
        </p>
      </article>
      <article class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Statica / WordPress Slim</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          WP come backend + front end statico/headless: velocissimo, sicuro e SEO-friendly. Ideale per volumi medi.
        </p>
      </article>
      <article class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Headless (Astro/Next.js + CMS)</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Front end moderno con API (WP/Strapi/Shopify Headless): performance top, scalabilità, integrazioni enterprise.
        </p>
      </article>
    </div>
  </section>

  <!-- ADD-ON -->
  <section class="container mx-auto px-6 py-8">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">Add-on consigliati</h2>
    <div class="grid md:grid-cols-3 gap-6">
      <article class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Core Web Vitals Express</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Audit + fix rapidi per LCP/INP/CLS. Migliora SEO e conversione.
        </p>
      </article>
      <article class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Local SEO Booster</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          GBP, Local Pack e recensioni: traffico locale che compra.
        </p>
      </article>
      <article class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/80 dark:bg-neutral-900/50">
        <h3 class="font-semibold">Consent Mode v2 + GA4 Pro</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">
          Tracciamento conforme e dati solidi per decisioni guidate dai KPI.
        </p>
      </article>
    </div>
  </section>

  <!-- COME LAVORIAMO -->
  <section class="container mx-auto px-6 py-10">
    <h2 class="text-2xl md:text-3xl font-bold mb-6">Come lavoriamo</h2>
    <div class="grid md:grid-cols-4 gap-6">
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <h3 class="font-semibold">1) Analisi & piano</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">Obiettivi, target, inventario, contenuti, baseline performance.</p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <h3 class="font-semibold">2) UX & design</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">Wireframe → UI → componenti riutilizzabili e accessibili.</p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <h3 class="font-semibold">3) Sviluppo & SEO</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">Build headless/WP Slim, schema, CWV, feed prodotto.</p>
      </div>
      <div class="rounded-2xl p-5 ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40">
        <h3 class="font-semibold">4) Lancio & monitor</h3>
        <p class="text-sm text-neutral-600 dark:text-neutral-300 mt-1">Test, setup pagamenti/spedizioni, monitoraggio e assistenza.</p>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="container mx-auto px-6 py-10">
    <h2 class="text-2xl md:text-3xl font-bold mb-4">FAQ</h2>
    <details class="group rounded-xl ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40 p-4 mb-3">
      <summary class="cursor-pointer font-medium">Che tecnologie usate? Posso scegliere un CMS?</summary>
      <div class="mt-2 text-sm text-neutral-700 dark:text-neutral-300">
        WooCommerce, WordPress Slim, Headless (Astro/Next.js) con CMS API (WP/Strapi/Shopify Headless).
      </div>
    </details>
    <details class="group rounded-xl ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40 p-4 mb-3">
      <summary class="cursor-pointer font-medium">In quanto tempo consegnate?</summary>
      <div class="mt-2 text-sm text-neutral-700 dark:text-neutral-300">
        Da 3–5 settimane per Start; Pro e headless 6–10 settimane (in base a catalogo e integrazioni).
      </div>
    </details>
    <details class="group rounded-xl ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40 p-4 mb-3">
      <summary class="cursor-pointer font-medium">Posso aggiornare i contenuti da solo?</summary>
      <div class="mt-2 text-sm text-neutral-700 dark:text-neutral-300">
        Sì: pannello intuitivo, ruoli e formazione inclusa.
      </div>
    </details>
    <details class="group rounded-xl ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40 p-4 mb-3">
      <summary class="cursor-pointer font-medium">È previsto il posizionamento e la garanzia?</summary>
      <div class="mt-2 text-sm text-neutral-700 dark:text-neutral-300">
        Garantiamo standard tecnici, UX e performance; per il ranking serve piano SEO continuativo.
      </div>
    </details>
    <details class="group rounded-xl ring-1 ring-neutral-200 dark:ring-neutral-800 bg-white/70 dark:bg-neutral-900/40 p-4">
      <summary class="cursor-pointer font-medium">Come gestite il tracciamento dati?</summary>
      <div class="mt-2 text-sm text-neutral-700 dark:text-neutral-300">
        Implementiamo Consent Mode v2, GA4, server-side tagging dove utile, e rispettiamo le policy privacy.
      </div>
    </details>
  </section>

  <!-- TESTIMONIANZE -->
  <Testimonials title="Cosa dicono i clienti" subtitle="Esperienze reali di chi ha scelto i nostri E-commerce." />

  <!-- CTA finale -->
  <CallToAction
    title="Pronto a vendere online con il piede giusto?"
    subtitle="Ti aiutiamo a scegliere la piattaforma, migrare e partire in sicurezza."
  >
    <span slot="actions">
      <a href="/contatti" class="btn-primary">Prenota una consulenza</a>
    </span>
  </CallToAction>
</Layout>